<!DOCTYPE html>
<html>
<title>&nbsp;</title>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css" />	
	<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>	
	<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?sensor=true"></script>
				
	<style>
		.mesgBox { 
			border-radius: 8px;
			border: 1px solid black;
			padding: 20px; 
			}
	</style>
	<script type="text/javascript" charset="utf-8"> 
		function boldLabel(str) {
			return '<b>' +str+ '</b>';
			}
			
		function textFormat(a) {
			return String(a);
			}
			
		function colrText(colr, txt) {
			return '<span style="color: '+colr+'">'+txt+'</span>';
			}
			
		function addGridRow(col, str) {
			/*
			<div class="ui-grid-a">
				<div class="ui-block-a">text inside a</div>
				<div class="ui-block-b">text inside b</div>
			</div><!-- /grid-a -->
			*/			
			return('<div class="ui-block-'+col+'">'+str+'</div>');
			}			
	</script>
	
	<script type="text/javascript" charset="utf-8"> 
		//*********************************************************    
		// Geolocation Capabilities
		//*********************************************************
		var geolocationInt;
		
		function updateGeolocationStatus(status) {
			$("#geolocationStatus").empty();
			$("#geolocationStatus").append(status);
		}
		
		function geolocationSuccess(position) {
			$("#geolocationProperties").empty();
			
			$("#geolocationProperties").append(addGridRow("a", boldLabel("Latitude:")));          
			$("#geolocationProperties").append(addGridRow("b", textFormat(position.coords.latitude)));
			
			$("#geolocationProperties").append(addGridRow("a", boldLabel("Longitude:")));         
			$("#geolocationProperties").append(addGridRow("b", textFormat(position.coords.longitude)));
			
			$("#geolocationProperties").append(addGridRow("a", boldLabel("Altitude:")));          
			$("#geolocationProperties").append(addGridRow("b", textFormat(position.coords.altitude)));
			
			$("#geolocationProperties").append(addGridRow("a", boldLabel("Accuracy:")));          
			$("#geolocationProperties").append(addGridRow("b", textFormat(position.coords.accuracy)));
			
			$("#geolocationProperties").append(addGridRow("a", boldLabel("Altitude Accuracy:"))); 
			$("#geolocationProperties").append(addGridRow("b", textFormat(position.coords.altitudeAccuracy)));
			
			$("#geolocationProperties").append(addGridRow("a", boldLabel("Heading:")));           
			$("#geolocationProperties").append(addGridRow("b", textFormat(position.coords.heading)));
			
			$("#geolocationProperties").append(addGridRow("a", boldLabel("Speed:")));             
			$("#geolocationProperties").append(addGridRow("b", textFormat(position.coords.speed)));
			
			$("#geolocationProperties").append(addGridRow("a", boldLabel("Timestamp:"))); 
			$("#geolocationProperties").append(addGridRow("b", toDateStr(new Date(position.timestamp))));
				
		}
		function geolocationError(error) {
			$("#geolocationProperties").append(addGridRow('a', boldLabel("ERROR:")));
			$("#geolocationProperties").append(addGridRow('b', error.message + " Code: " + error.code));
			updateGeolocationStatus("ERROR");
		} 

		function getGeolocationInfo() {
			if ( geolocationInt != undefined ) {
				navigator.geolocation.clearWatch(geolocationInt);
			}
			if ( $("#geolocFreq").val() != 1 ) {
				$("#geolocFreq").val(1).slider("refresh");
			}
			
			navigator.geolocation.getCurrentPosition(geolocationSuccess, geolocationError, {enableHighAccuracy:true, timeout:5000});
			updateGeolocationStatus("Initialized");     
		}
		
		function updateGeolocation() {
			if ( geolocationInt != undefined ) {
				navigator.geolocation.clearWatch(geolocationInt);
			}
			
			var uDefFreq = $("#geolocFreq").val();
			
			if ( uDefFreq > 0 ) {
				// The Android 2.x simulators will not return a geolocation result unless the enableHighAccuracy option is set to true. 
				geolocationInt = navigator.geolocation.watchPosition(geolocationSuccess, geolocationError, {enableHighAccuracy:true, timeout:5000, maximumAge: uDefFreq * 1000});
			}
			updateGeolocationStatus("Updating... Frequency: " + uDefFreq + " sec");
		}
		
		function stopUpdateGeolocation() {
			navigator.geolocation.clearWatch(geolocationInt);
			geolocationInt = undefined;
			updateGeolocationStatus("Stopped");
		}
	</script>
	
	<script type="text/javascript" charset="utf-8">
		//*********************************************************    
		// Event Capabilities
		//*********************************************************
		function updateEventStatus(status) {
			$("#eventStatus").empty();
			$("#eventStatus").append(status).trigger("create");
		}

		function batteryStatusEvt(e) {
			alert(e.type + " event created." + "\nBattery Level: " + e.level + "\nCharger plugin? " + e.isPlugged);
		}
		
		function menuEvt(e) {
			alert(e.type + " event created.");
		}

		function toggleBatteryStatusEvent() {
			if ( $("#flip-batteryStatus option:selected").val() == "on" ) {
				updateEventStatus("Enable battery status event");
				window.addEventListener("batterystatus", batteryStatusEvt, false);          
			} else {
				updateEventStatus("Disable battery status event");
				window.removeEventListener("batterystatus", batteryStatusEvt, false);
			}
		}

		function toggleMenuEvent() {
			if ( $("#flip-menu option:selected").val() == "on" ) {
				updateEventStatus("Enable menu button event");
				document.addEventListener("menubutton", menuEvt, false);
			} else {
				updateEventStatus("Disable menu button event");
				document.removeEventListener("menubutton", menuEvt, false);
			}
		}
	</script>	
	
	
</head>
	
<body>	
<!---------------------------------- Main Page --------------------------------------->
<div data-role="page" id="main">
    <div data-role="header" data-position="fixed">
        <h1 id="appTitle"></h1>
    </div>
    <div data-role="content">   
    <ul data-role="listview" data-inset="true" data-filter="true">
        <li><a href="#geolocationInfo" onclick="getGeolocationInfo();">Geolocation</a></li>
        <li><a href="#eventCap" onclick="getEventsReady();">Event</a></li>          
    </ul>
    </div>
</div>


<!---------------------------------- Geolocation ------------------------------------->
<!-- http://demos.jquerymobile.com/1.2.1/docs/pages/page-links.html -->
<div data-role="page" id="geolocationInfo">
    <div data-role="header">
		<a data-rel="back" data-ajax="false" data-icon="arrow-l">Tilbake</a>
        <h1>Geolocation</h1>
    </div>
    <div data-role="content">
        <div id="geolocationProperties" class="mesgBox ui-grid-a"></div>
        <div data-role="fieldcontain">
            <form>
                <label class="smFont" for="geolocFreq">Update frequency (in seconds)</label>
                <input type="range" name="geolocFreq" id="geolocFreq" value="1" min="0" max="10" step="1" data-highlight="true"/>
            </form>
            <a href="#" data-role="button" onclick="updateGeolocation();">Start update</a>
            <a href="#" data-role="button" onclick="stopUpdateGeolocation();">Stop update</a>
        </div>
    </div>
    <div data-role="footer" data-position="fixed">
        <div id="geolocationStatus"></div>
    </div>
</div>


<!---------------------------------- Event ------------------------------------------>          
<div data-role="page" data-add-back-btn="true" back-btn-text="back" id="eventCap">
    <div data-role="header">
        <h1>Event Types</h1>
    </div>
    <div data-role="content">
        <form>
            <ul id="eventListView" data-role="listview" data-inset="true">
                <li data-role="fieldcontain">
                    <label for="flip-batteryStatus" class="smFont">Battery Status</label>
                    <select name="flip-batteryStatus" id="flip-batteryStatus" data-role="slider" data-mini="true" onchange="toggleBatteryStatusEvent();">
                        <option value="off">Off</option>
                        <option value="on">On</option>
                    </select>
                </li>
                <li data-role="fieldcontain" class="smFont">
                    <label for="flip-menu" class="smFont">Menu</label>
                    <select name="flip-menu" id="flip-menu" data-role="slider" data-mini="true" onchange="toggleMenuEvent();">
                        <option value="off">Off</option>
                        <option value="on">On</option>
                    </select>
                </li>
            </ul>
        </form>         

            <div class="mesgBox">
                <h5 class="hlabel">There are a handful of events you can implement in PhoneGap.  Here are 2 examples:</h5>
                <ul  class="smFont">
                    <li>Battery Event - triggered when % of battery changed by > 1% or phone is plugged/un-plugged.</li>
                    <li>Menu Event - show a popup when the menu button is pressed.</li>
                </ul>           
            </div>
    </div>
    <div data-role="footer">
        <div id="eventStatus"></div>
    </div>
</div>  


</body>

</html>
